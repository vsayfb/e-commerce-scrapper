<!DOCTYPE html>
<html>
<head>
    <title>Search Form</title>
</head>
<body>
<h1>Search Form</h1>
<form id="search">
    <label for="keyword">Enter keyword:</label>
    <input type="text" id="keyword" name="keyword" required>
    <input type="submit" value="Search">
</form>

<ul id="output">
</ul>


<script>

    const form = document.getElementById("search")
    const output = document.getElementById("output");


    form.addEventListener("submit", function (ev) {

        ev.preventDefault()

        const inp = form.getElementById("keyword")

        socket.send(inp.value + "-" + 0)

        inp.value = "";
    })


    let socket = new WebSocket('ws://localhost:5555/search');


    socket.addEventListener('message', (e) => {
        const result = JSON.parse(e.data)

        output.innerHTML = '';

        result.forEach((p) => {
            const pDiv = document.createElement("li")

            pDiv.innerHTML = ` <h2>${p.title}</h2>
                <p><strong>Site:</strong> ${p.site}</p>
                <p><strong>Price:</strong> ${p.price}</p>
                <p><strong>URL:</strong> <a href="${p.url}" target="_blank">${p.url}</a></p>
                <img src="${p.image}" alt="${p.title} Image">`

            output.appendChild(pDiv)

        })

    });

</script>

</body>
</html>
